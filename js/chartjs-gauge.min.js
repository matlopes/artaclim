/*!
 * chartjs-gauge.js v0.1.2
 * https://github.com/haiiaaa/chartjs-gauge/
 * (c) 2020 chartjs-gauge.js Contributors
 * Released under the MIT License
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("chart.js")):"function"==typeof define&&define.amd?define(["chart.js"],e):(t=t||self).Gauge=e(t.Chart)}(this,(function(t){"use strict";function e(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function a(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}(t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t).defaults._set("gauge",{needle:{radiusPercentage:2,widthPercentage:3.2,lengthPercentage:80,color:"rgba(0, 0, 0, 1)"},valueLabel:{display:!0,formatter:null,color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 1)",borderRadius:5,padding:{top:5,right:5,bottom:5,left:5},bottomMarginPercentage:5},animation:{duration:1e3,animateRotate:!0,animateScale:!1},cutoutPercentage:50,rotation:-Math.PI,circumference:Math.PI,legend:{display:!1},tooltips:{enabled:!1}});var r=t.controllers.doughnut.extend({getMaxValue:function(t){return t[t.length-1]||1},getWidth:function(t){return t.chartArea.right-t.chartArea.left},getTranslation:function(t){var e=t.chartArea,a=t.offsetX,r=t.offsetY;return{dx:(e.left+e.right)/2+a,dy:(e.top+e.bottom)/2+r}},getAngle:function(t){var e=t.chart,a=t.value,r=t.maxValue,n=e.options;return n.rotation+n.circumference*(a/r)},drawNeedle:function(t){this.chart.animating||(t=1);var e=this.chart,a=e.ctx,r=e.config,n=e.innerRadius,o=e.outerRadius,i=r.data.datasets[this.index],l=this.getMeta().previous,s=r.options.needle,c=s.radiusPercentage,u=s.widthPercentage,h=s.lengthPercentage,d=s.color,g=this.getWidth(this.chart),f=c/100*g,p=u/100*g,b=h/100*(o-n)+n,m=this.getTranslation(this.chart),v=m.dx,y=m.dy,x=this.getAngle({chart:this.chart,value:l.value,maxValue:l.maxValue}),P=x+(this.getAngle({chart:this.chart,value:i.value,maxValue:this.getMaxValue(i.data)})-x)*t;a.save(),a.translate(v,y),a.rotate(P),a.fillStyle=d,a.beginPath(),a.ellipse(0,0,f,f,0,0,2*Math.PI),a.fill(),a.beginPath(),a.moveTo(0,p/2),a.lineTo(b,0),a.lineTo(0,-p/2),a.fill(),a.restore()},drawValueLabel:function(e){if(this.chart.config.options.valueLabel.display){var a=this.chart,r=a.ctx,n=a.config,o=n.data.datasets[this.index],i=n.options.valueLabel,l=i.formatter,s=i.color,c=i.backgroundColor,u=i.borderRadius,h=i.padding,d=i.bottomMarginPercentage/100*this.getWidth(this.chart),g=(l||function(t){return t})(o.value).toString();r.textBaseline="middle",r.textAlign="center";var f=r.measureText(g).width,p=Math.max(r.measureText("m").width,r.measureText("ï¼·").width),b=-(h.left+f/2),m=-(h.top+p/2),v=h.left+f+h.right,y=h.top+p+h.bottom,x=this.getTranslation(this.chart),P=x.dx,w=x.dy,O=this.chart.options.rotation%(2*Math.PI);P+=d*Math.cos(O+Math.PI/2),w+=d*Math.sin(O+Math.PI/2),r.save(),r.translate(P,w),r.beginPath(),t.helpers.canvas.roundedRect(r,b,m,v,y,u),r.fillStyle=c,r.fill(),r.fillStyle=s||n.options.defaultFontColor;r.fillText(g,0,.075*p),r.restore()}},update:function(e){var a=this.chart.config.data.datasets[this.index],r=this.getMeta(),n={value:0,maxValue:1};e?(r.previous=null,r.current=n):(a.data.sort((function(t,e){return t-e})),r.previous=r.current||n,r.current={value:a.value,maxValue:this.getMaxValue(a.data)}),t.controllers.doughnut.prototype.update.call(this,e)},updateElement:function(r,n,o){t.controllers.doughnut.prototype.updateElement.call(this,r,n,o);var i=this.getDataset().data,l=this.chart.config.options,s=this.getMaxValue(i),c=i[n-1]||0,u=i[n],h=l.rotation+l.circumference*(c/s),d=h+l.circumference*((u-c)/s),g=d-h;r._model=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?a(Object(n),!0).forEach((function(a){e(t,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},r._model,{startAngle:h,endAngle:d,circumference:g})},draw:function(e){t.controllers.doughnut.prototype.draw.call(this,e),this.drawNeedle(e),this.drawValueLabel(e)}});return void 0===CanvasRenderingContext2D.prototype.ellipse&&(CanvasRenderingContext2D.prototype.ellipse=function(t,e,a,r,n,o,i,l){this.save(),this.translate(t,e),this.rotate(n),this.scale(a,r),this.arc(0,0,1,o,i,l),this.restore()}),t.controllers.gauge=r,t.Gauge=function(e,a){return a.type="gauge",new t(e,a)},t.Gauge}));
